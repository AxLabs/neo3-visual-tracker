using System;
using System.ComponentModel;
using System.Numerics;

using Neo.SmartContract.Framework;
using Neo.SmartContract.Framework.Services.Neo;
using Neo.SmartContract.Framework.Services.System;

namespace $_NAMESPACENAME_$
{
    [DisplayName("YourName.$_CLASSNAME_$")]
    [ManifestExtra("Author", "Your name")]
    [ManifestExtra("Email", "your@address.invalid")]
    [ManifestExtra("Description", "Describe your contract...")]
    public class $_CLASSNAME_$ : SmartContract
    {
        const string MAP_NAME = "$_CLASSNAME_$";

        [DisplayName("NumberChanged")]
        public static event Action<Neo.UInt160, BigInteger> OnNumberChanged;

        public static bool ChangeNumber(BigInteger positiveNumber)
        {
            if (positiveNumber < 0)
            {
                throw new Exception("Only positive numbers are allowed.");
            }

            var tx = (Transaction) ExecutionEngine.ScriptContainer;

            var storageMap = Storage.CurrentContext.CreateMap(MAP_NAME);

            storageMap.Put(tx.Sender.Serialize(), positiveNumber.ToByteArray());

            OnNumberChanged(tx.Sender, positiveNumber);

            return true;
        }

        public static BigInteger GetNumber()
        {
            var tx = (Transaction) ExecutionEngine.ScriptContainer;

            var storageMap = Storage.CurrentContext.CreateMap(MAP_NAME);

            return new BigInteger(storageMap.Get(tx.Sender.Serialize()));
        }
    }
}
